package com.example.cveexplorer.entity;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.validation.constraints.NotEmpty;
import java.util.Date;
import java.util.Objects;

@Entity
public
class Cve {

	// this CVE was created via this API
	public static final String SOURCE_TYPE_API = "API";

	// this CVE was sourced from https://nvd.nist.gov/
	public static final String SOURCE_TYPE_NVD = "NVD";

	// this CVE is a TEST
	public static final String SOURCE_TYPE_TEST = "TEST";

	public static final int MAX_DESCRIPTION_LEN = 2000;

	@Id
	@GeneratedValue
	private Long id;

	// unique identifier for this cve
	@Column(unique = true)
	private String cveId;

	// short description of this vulnerability
	@NotEmpty(message = "Description is required")
	@Column(length = MAX_DESCRIPTION_LEN)
	private String description;

	// severity - LOW, HIGH
	private String severity;

	// date CVE was first published
	private Date published;

	// date CVE was modified
	private Date modified;

	// the publishing source for this CVE
	private String source;

	public Cve() {
	}

	public Long getId() {
		return this.id;
	}

	public void setId(Long id) {
		this.id = id;
	}

	public String getCveId() {
		return cveId;
	}

	public Cve setCveId(String cveId) {
		this.cveId = cveId;
		return this;
	}

	public String getDescription() {
		return description;
	}

	public Cve setDescription(String description) {
		this.description = description.length() > MAX_DESCRIPTION_LEN ? description.substring(0, MAX_DESCRIPTION_LEN) : description;
		return this;
	}

	public String getSeverity() {
		return severity;
	}

	public Date getPublished() {
		return published;
	}

	public Cve setSeverity(String severity) {
		this.severity = severity;
		return this;
	}

	public Cve setPublished(Date published) {
		this.published = published;
		return this;
	}

	public Date getModified() {
		return modified;
	}

	public Cve setModified(Date modified) {
		this.modified = modified;
		return this;
	}

	public String getSource() {
		return source;
	}

	public Cve setSource(String source) {
		this.source = source;
		return this;
	}

	@Override
	public boolean equals(Object o) {
		if (this == o)
			return true;
		if (!(o instanceof Cve))
			return false;
		Cve cve = (Cve) o;
		return Objects.equals(this.id, cve.id) && Objects.equals(this.cveId, cve.cveId);
	}

	@Override
	public int hashCode() {
		return Objects.hash(this.id, this.cveId, this.description, this.severity, this.published, this.modified, this.source);
	}

	@Override
	public String toString() {
		return cveId;
	}
}
